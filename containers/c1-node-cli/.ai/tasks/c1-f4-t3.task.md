# Task 3 for Plan c1-f4

Create an adapter for the Commander library to abstract the external dependency and provide a consistent interface for command handling.

**Layer**: system  
**Status**: not-started

### Reference

- [Feature Blueprint](/docs/f4-command-handling.blueprint.md)
- [Implementation Plan](/containers/c1-node-cli/docs/f4-command-handling.plan.md)
- [Language coding rules](/containers/c1-node-cli/.ai/rules/0-typescript.rules.md)  
- [Node CLI rules](/containers/c1-node-cli/.ai/rules/1-node-cli.rules.md)
- [System Layer rules](/containers/c1-node-cli/.ai/rules/2-system-layer.rules.md)

## Instructions

### Create Commander Adapter Interface

`src/system/commandParser.adapter.ts`:
- Import required types from `command.types.ts` and `commandResult.types.ts`
- Create a `CommandParserAdapter` interface with methods:
  - `registerCommand(command: Command): void`
  - `parseArgs(args: string[]): Promise<ParsedInput>`
  - `showHelp(command?: string): void`
  - `execute(commandName: string, args: string[], options: Record<string, any>): Promise<CommandResult>`

### Implement Commander Adapter

`src/system/commanderParser.adapter.ts`:
- Add the Commander library as a dependency (in package.json)
- Import the Commander package
- Implement the `CommandParserAdapter` interface
- Create a class `CommanderParserAdapter` that:
  - Initializes a Commander program instance
  - Maps our Command interface to Commander's command structure
  - Translates Commander's parsed arguments to our normalized format
  - Handles options and flags according to our interface
  - Provides error handling for Commander-specific issues
  - Maintains isolation between the application and the external library
- Create a singleton instance of the adapter to be used throughout the application

### Create Adapter Factory

`src/system/commandParserFactory.util.ts`:
- Implement a factory function `createCommandParser()` that returns the CommanderParserAdapter instance
- This factory will be the only place that directly references the Commander implementation
- Add configuration options for the parser (if needed)

> End of programming instructions for task c1-f4-t3. 