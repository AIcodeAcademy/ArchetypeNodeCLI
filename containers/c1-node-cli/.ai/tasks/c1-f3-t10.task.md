# Task 10 for Plan c1-f3

Define log event types and handlers

**Layer**: domain  
**Status**: not-started

### Reference

- [Feature Blueprint](/docs/f3-logging.blueprint.md)
- [Implementation Plan](/containers/c1-node-cli/docs/f3-logging.plan.md)
- [Language coding rules](/containers/c1-node-cli/.ai/rules/0-typescript.rules.md)  
- [Node CLI rules](/containers/c1-node-cli/.ai/rules/1-node-cli.rules.md)
- [Domain Layer rules](/containers/c1-node-cli/.ai/rules/3-domain-layer.rules.md)

## Instructions

- `src/domain/logger/logEvent.type.ts` : Define event types
  - Create a type `LogEventType` as a union of string literals ('log_created', 'log_level_changed', 'threshold_exceeded', 'pattern_detected')
  - Define an interface `LogEvent` with properties:
    - `type: LogEventType` - Type of event
    - `timestamp: number` - When the event occurred
    - `payload: unknown` - Event-specific data
  - Create specific event interfaces extending LogEvent for each event type
  - Define a type `LogEventFilter` for subscriptions

- `src/domain/logger/logEventEmitter.ts` : Implement event emitter
  - Create a function `createLogEventEmitter()` that returns an event emitter
  - Implement methods:
    - `emit(event: LogEvent): void` - Emit an event
    - `on(eventType: LogEventType, handler: (event: LogEvent) => void): () => void` - Subscribe to events
    - `off(eventType: LogEventType, handler: (event: LogEvent) => void): void` - Unsubscribe
    - `once(eventType: LogEventType, handler: (event: LogEvent) => void): () => void` - One-time subscription
  - Create helper functions to create and emit specific event types

- `src/domain/logger/logAlert.ts` : Implement alert system
  - Create an interface `LogAlertRule` with properties:
    - `id: string` - Unique identifier
    - `name: string` - Human-readable name
    - `condition: (entry: LogEntry) => boolean` - Alert condition
    - `throttle?: number` - Minimum time between alerts
  - Implement a function `createLogAlert(rule: LogAlertRule): (entry: LogEntry) => boolean`
  - Create predefined alert rules:
    - `errorThresholdRule(count: number, timeWindow: number): LogAlertRule`
    - `patternMatchRule(pattern: RegExp, level?: LogLevel): LogAlertRule`
    - `anomalyDetectionRule(baseline: LogEntry[]): LogAlertRule`

- `src/domain/logger/logNotification.ts` : Implement notification system
  - Create a type `NotificationType` as a union of string literals ('console', 'event')
  - Define an interface `LogNotificationHandler` with a method `notify(alert: LogEvent): Promise<void>`
  - Implement a function `createConsoleNotifier(): LogNotificationHandler`
  - Create a function `createEventNotifier(emitter: any): LogNotificationHandler`
  - Implement a function `createCompositeNotifier(handlers: LogNotificationHandler[]): LogNotificationHandler`

- `src/domain/logger/index.ts` : Update the barrel file
  - Export all event and alert types and utilities

> End of programming instructions for task 10. 